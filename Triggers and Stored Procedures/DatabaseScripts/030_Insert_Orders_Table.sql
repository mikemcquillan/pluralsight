USE StockSystem;

GO

DECLARE @OrderDate1		DATE = '2023-11-04',
		@OrderDate2		DATE = '2023-12-10',
		@OrderDate3		DATE = '2024-01-30';

INSERT INTO dbo.OrderHeader
	(CustomerId, OrderReference, OrderDate)
SELECT	CustomerId,
		'Ref 100-' + CONVERT(VARCHAR(10), CustomerId),
		@OrderDate1
	FROM dbo.Customer
WHERE CustomerId < 21
UNION
SELECT	CustomerId,
		'Ref 200-' + CONVERT(VARCHAR(10), CustomerId),
		@OrderDate2
	FROM dbo.Customer
WHERE CustomerId < 21
UNION
SELECT	CustomerId,
		'Ref 300-' + CONVERT(VARCHAR(10), CustomerId),
		@OrderDate3
	FROM dbo.Customer
WHERE CustomerId > 20;

INSERT INTO dbo.OrderLine
	(OrderHeaderId, StockItemId, Quantity, ItemCost)
SELECT *
	FROM
	(
	 SELECT	CASE SI.StockItemId
				WHEN 7 THEN 1
				WHEN 10 THEN 1
				WHEN 11 THEN 1
				WHEN 14 THEN 2
				WHEN 22 THEN 3
				WHEN 23 THEN 3
				WHEN 28 THEN 4
				WHEN 32 THEN 4
				WHEN 39 THEN 5
				WHEN 41 THEN 6
				WHEN 62 THEN 7
				WHEN 63 THEN 8
				WHEN 82 THEN 9
				WHEN 88 THEN 9
				WHEN 98 THEN 10
				WHEN 101 THEN 11
				WHEN 149 THEN 12
				WHEN 153 THEN 12
				WHEN 156 THEN 12
				WHEN 300 THEN 13
				WHEN 303 THEN 13
				WHEN 302 THEN 13
				WHEN 330 THEN 14
				WHEN 335 THEN 15
				WHEN 353 THEN 16
				WHEN 367 THEN 17
				WHEN 372 THEN 17
				WHEN 416 THEN 18
				WHEN 446 THEN 19
				WHEN 496 THEN 20
				WHEN 500 THEN 21
				WHEN 501 THEN 21
				WHEN 502 THEN 21
				WHEN 507 THEN 21
				WHEN 528 THEN 22
				WHEN 538 THEN 23
				WHEN 548 THEN 23
				WHEN 551 THEN 24
				WHEN 636 THEN 25
				WHEN 650 THEN 25
				WHEN 686 THEN 26
				WHEN 689 THEN 26
				WHEN 693 THEN 27
				WHEN 703 THEN 27
				WHEN 705 THEN 27
				WHEN 712 THEN 28
				WHEN 719 THEN 29
				WHEN 720 THEN 29
				WHEN 721 THEN 30
				WHEN 729 THEN 31
				WHEN 730 THEN 31
				WHEN 731 THEN 31
				WHEN 740 THEN 32
				WHEN 749 THEN 33
				WHEN 767 THEN 34
				WHEN 768 THEN 34
				WHEN 821 THEN 35
				WHEN 826 THEN 36
				WHEN 854 THEN 37
				WHEN 855 THEN 37
				WHEN 856 THEN 38
				WHEN 949 THEN 39
				WHEN 950 THEN 40
				WHEN 948 THEN 40
				WHEN 963 THEN 41
				WHEN 972 THEN 42
				WHEN 975 THEN 42
				WHEN 983 THEN 43
				WHEN 992 THEN 44
				WHEN 993 THEN 44
				WHEN 1005 THEN 44
				WHEN 1014 THEN 44
			END AS OrderHeaderId,
			SI.StockItemId, 
			CASE SI.StockItemId
				WHEN 7 THEN 1
				WHEN 10 THEN 2
				WHEN 11 THEN 1
				WHEN 14 THEN 2
				WHEN 22 THEN 3
				WHEN 23 THEN 1
				WHEN 28 THEN 1
				WHEN 32 THEN 4
				WHEN 39 THEN 2
				WHEN 41 THEN 1
				WHEN 62 THEN 3
				WHEN 63 THEN 5
				WHEN 82 THEN 1
				WHEN 88 THEN 1
				WHEN 98 THEN 2
				WHEN 101 THEN 1
				WHEN 149 THEN 2
				WHEN 153 THEN 1
				WHEN 156 THEN 2
				WHEN 300 THEN 3
				WHEN 303 THEN 1
				WHEN 302 THEN 3
				WHEN 330 THEN 4
				WHEN 335 THEN 2
				WHEN 353 THEN 6
				WHEN 367 THEN 10
				WHEN 372 THEN 1
				WHEN 416 THEN 2
				WHEN 446 THEN 7
				WHEN 496 THEN 1
				WHEN 500 THEN 3
				WHEN 501 THEN 4
				WHEN 502 THEN 5
				WHEN 507 THEN 4
				WHEN 528 THEN 3
				WHEN 538 THEN 2
				WHEN 548 THEN 1
				WHEN 551 THEN 1
				WHEN 636 THEN 1
				WHEN 650 THEN 2
				WHEN 686 THEN 2
				WHEN 689 THEN 3
				WHEN 693 THEN 3
				WHEN 703 THEN 4
				WHEN 705 THEN 5
				WHEN 712 THEN 3
				WHEN 719 THEN 2
				WHEN 720 THEN 2
				WHEN 721 THEN 3
				WHEN 729 THEN 1
				WHEN 730 THEN 1
				WHEN 731 THEN 2
				WHEN 740 THEN 6
				WHEN 749 THEN 5
				WHEN 767 THEN 3
				WHEN 768 THEN 4
				WHEN 821 THEN 1
				WHEN 826 THEN 1
				WHEN 854 THEN 8
				WHEN 855 THEN 2
				WHEN 856 THEN 3
				WHEN 949 THEN 4
				WHEN 950 THEN 5
				WHEN 948 THEN 1
				WHEN 963 THEN 1
				WHEN 972 THEN 2
				WHEN 975 THEN 2
				WHEN 983 THEN 3
				WHEN 992 THEN 4
				WHEN 993 THEN 1
				WHEN 1005 THEN 3
				WHEN 1014 THEN 4
			END AS Quantity,
			SIP.ItemPrice
		FROM StockItem SI 
			INNER JOIN StockItemPrice SIP 
				ON SI.StockItemId = SIP.StockItemId
	 WHERE GETDATE() BETWEEN SIP.StartDate AND COALESCE(SIP.enddate, GETDATE())
	) x
	WHERE OrderHeaderId IS NOT NULL; 

--SELECT	OH.OrderHeaderId,
--		C.CustomerName,
--		OH.OrderReference,
--		OH.OrderDate,
--		OH.TotalCost,
--		SI.Title,
--		OL.Quantity,
--		OL.ItemCost,
--		OL.Quantity
--FROM dbo.OrderHeader OH
--	INNER JOIN dbo.Customer C
--		ON OH.CustomerId = C.CustomerId
--	INNER JOIN dbo.OrderLine OL
--		ON OH.OrderHeaderId = OL.OrderHeaderId
--	INNER JOIN dbo.StockItem SI
--		ON OL.StockItemId = SI.StockItemId;

GO